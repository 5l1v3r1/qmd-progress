language: c

sudo: required
dist: trusty

sources:
  - ubuntu-toolchain-r-test
  - llvm-toolchain-precise-3.6

os:
  - linux

before_install:
  - sudo apt-get install gfortran libblas-dev liblapack-dev
  - sudo apt-get install cmake python gcc cmake-data g++
  - sudo apt-get install python-numpy python3-numpy
  - export MY_PATH=`pwd`
  - git clone -b develop https://github.com/qmmd/bml.git
#  - cd; wget http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/metis-5.1.0.tar.gz
#  - tar -xvzf metis-5.1.0.tar.gz
#  - cd metis-5.1.0; make config; make; cd


before_script:
  - echo "before script"
  - cd bml; sh example_build.sh
  - cd build; make; make install
  - cd $MY_PATH

#env:
  # - CMAKE_BUILD_TYPE=Release FC=gfortran CC=gcc
  # - CMAKE_BUILD_TYPE=Release FC=gfortran CC=gcc

script:
  -  sh example_build.sh
  -  cd build; make; make test
  -  cd ../examples/gpmd; ./run_test.sh

after_success:
  - echo "success"
